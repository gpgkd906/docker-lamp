<VirtualHost *:80>
    ServerName framework.local
    ServerAlias framework
    DocumentRoot /usr/local/apache2/htdocs

    # Uncomment the following line to force Apache to pass the Authorization
    # header to PHP: required for "basic_auth" under PHP-FPM and FastCGI
    #
    # SetEnvIfNoCase ^Authorization$ "(.+)" HTTP_AUTHORIZATION=$1

    <FilesMatch \.php$>
        SetHandler proxy:fcgi://php_server:9000/application/index.php
    </FilesMatch>

    <Directory /usr/local/apache2/htdocs>
        # enable the .htaccess rewrites
        AllowOverride ALL
        Require all granted
	# from .htaccess
	Options FollowSymLinks
	DirectoryIndex index.php

	RewriteEngine On
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteCond %{REQUEST_FILENAME} !-d

	ReWriteBase /

	ReWriteRule ^(.*)$ fcgi://php_server:9000/application/index.php?req=$1&%{QUERY_STRING} [L]
    </Directory>

    ErrorLog /usr/local/apache2/logs/framework_error.log
    CustomLog /usr/local/apache2/logs/framework_access.log combined
</VirtualHost>